<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Courses - Teacher - FUNLEARN</title>
    <link rel="stylesheet" href="/tailwind.css">
    <link rel="stylesheet" href="/funlearn-styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body class="bg-gray-50">
    {{> header}}

    <div class="container mx-auto px-6 py-8">
        <!-- Success Message -->
        {{#if successMessage}}
        <div class="mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg flex items-center justify-between">
            <div class="flex items-center">
                <i class="fas fa-check-circle text-green-500 mr-3"></i>
                <span>{{successMessage}}</span>
            </div>
            <button onclick="this.parentElement.style.display='none'" class="text-green-700 hover:text-green-900">
                <i class="fas fa-times"></i>
            </button>
        </div>
        {{/if}}

        <!-- Error Message -->
        {{#if errorMessage}}
        <div class="mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg flex items-center justify-between">
            <div class="flex items-center">
                <i class="fas fa-exclamation-circle text-red-500 mr-3"></i>
                <span>{{errorMessage}}</span>
            </div>
            <button onclick="this.parentElement.style.display='none'" class="text-red-700 hover:text-red-900">
                <i class="fas fa-times"></i>
            </button>
        </div>
        {{/if}}

        <!-- Header -->
        <div class="flex items-center justify-between mb-8">
            <div>
                <h1 class="text-4xl font-bold text-gray-800">My Courses</h1>
                <p class="text-gray-600 mt-2">Manage and create engaging learning experiences</p>
            </div>
            <div class="flex items-center space-x-3">
                <a href="/teacher/dashboard" class="btn btn-secondary">
                    <i class="fas fa-arrow-left mr-2"></i>Back to Dashboard
                </a>
                <a href="/teacher/courses/create" class="btn btn-primary">
                    <i class="fas fa-plus mr-2"></i>Create Course
                </a>
            </div>
        </div>

        <!-- Course Stats -->
        <div class="grid md:grid-cols-4 gap-6 mb-8">
            <div class="stat-card card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="stat-label">Total Courses</p>
                        <p class="stat-value text-blue-600">{{courses.length}}</p>
                    </div>
                    <div class="text-4xl opacity-20">üìö</div>
                </div>
            </div>

            <div class="stat-card card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="stat-label">Published</p>
                        <p class="stat-value text-green-600">3</p>
                    </div>
                    <div class="text-4xl opacity-20">‚úÖ</div>
                </div>
            </div>

            <div class="stat-card card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="stat-label">Draft Courses</p>
                        <p class="stat-value text-orange-600">1</p>
                    </div>
                    <div class="text-4xl opacity-20">üìù</div>
                </div>
            </div>

            <div class="stat-card card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="stat-label">Total Students</p>
                        <p class="stat-value text-purple-600">105</p>
                    </div>
                    <div class="text-4xl opacity-20">üë•</div>
                </div>
            </div>
        </div>

        <!-- Filters and Search -->
        <div class="card p-6 mb-8">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
                <div class="flex items-center space-x-4">
                    <div>
                        <input type="search" placeholder="Search courses..." 
                               class="form-input w-64" id="courseSearch">
                    </div>
                    <div>
                        <select class="form-input w-40" id="categoryFilter">
                            <option value="">All Categories</option>
                            <option value="Programming">Programming</option>
                            <option value="Database">Database</option>
                            <option value="Security">Security</option>
                            <option value="Design">Design</option>
                        </select>
                    </div>
                    <div>
                        <select class="form-input w-40" id="statusFilter">
                            <option value="">All Status</option>
                            <option value="published">Published</option>
                            <option value="draft">Draft</option>
                        </select>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <button class="btn btn-secondary btn-sm" onclick="toggleView('grid')">
                        <i class="fas fa-th-large"></i>
                    </button>
                    <button class="btn btn-secondary btn-sm" onclick="toggleView('list')">
                        <i class="fas fa-list"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Courses Grid -->
        <div id="coursesContainer">
            {{#if courses.length}}
                <div id="gridView" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {{#each courses}}
                    <div class="course-card card-hover" data-category="{{this.category}}" data-status="{{#if this.is_published}}published{{else}}draft{{/if}}">
                        <div class="relative">
                            <!-- Course Thumbnail -->
                            <div class="h-48 bg-gradient-to-br from-blue-500 to-purple-600 rounded-t-lg flex items-center justify-center">
                                <div class="text-6xl text-white opacity-80">üìö</div>
                            </div>
                            
                            <!-- Status Badge -->
                            <div class="absolute top-4 right-4">
                                {{#if this.is_published}}
                                <span class="bg-green-500 text-white px-2 py-1 rounded-full text-xs font-semibold">
                                    Published
                                </span>
                                {{else}}
                                <span class="bg-orange-500 text-white px-2 py-1 rounded-full text-xs font-semibold">
                                    Draft
                                </span>
                                {{/if}}
                            </div>
                        </div>
                        
                        <div class="p-6">
                            <div class="flex items-start justify-between mb-3">
                                <h3 class="text-xl font-bold text-gray-800 line-clamp-2">{{this.title}}</h3>
                            </div>
                            
                            <p class="text-gray-600 text-sm mb-4 line-clamp-2">{{this.description}}</p>
                            
                            <div class="flex items-center space-x-4 mb-4 text-sm text-gray-500">
                                <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded">{{this.category}}</span>
                                <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded capitalize">{{this.difficulty_level}}</span>
                            </div>
                            
                            <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                                <span>üìñ {{this.lessons_count}} lessons</span>
                                <span>üë• {{this.students_enrolled}} students</span>
                                <span>‚è±Ô∏è {{this.estimated_duration}}min</span>
                            </div>
                            
                            <div class="flex items-center space-x-2">
                                <a href="/teacher/courses/{{this.id}}/edit" class="btn btn-primary btn-sm flex-1">
                                    <i class="fas fa-edit mr-1"></i>Edit
                                </a>
                                <button class="btn btn-secondary btn-sm" onclick="duplicateCourse({{this.id}})">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <button class="btn btn-secondary btn-sm text-red-600" onclick="deleteCourse({{this.id}})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    {{/each}}
                </div>

                <!-- List View (Hidden by default) -->
                <div id="listView" class="hidden space-y-4">
                    {{#each courses}}
                    <div class="course-card p-6" data-category="{{this.category}}" data-status="{{#if this.is_published}}published{{else}}draft{{/if}}">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4 flex-1">
                                <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center text-white text-2xl">
                                    üìö
                                </div>
                                <div class="flex-1">
                                    <div class="flex items-center space-x-3 mb-2">
                                        <h3 class="text-xl font-bold text-gray-800">{{this.title}}</h3>
                                        {{#if this.is_published}}
                                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-semibold">
                                            Published
                                        </span>
                                        {{else}}
                                        <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-semibold">
                                            Draft
                                        </span>
                                        {{/if}}
                                    </div>
                                    <p class="text-gray-600 mb-2">{{this.description}}</p>
                                    <div class="flex items-center space-x-4 text-sm text-gray-500">
                                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded">{{this.category}}</span>
                                        <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded capitalize">{{this.difficulty_level}}</span>
                                        <span>üìñ {{this.lessons_count}} lessons</span>
                                        <span>üë• {{this.students_enrolled}} students</span>
                                        <span>‚è±Ô∏è {{this.estimated_duration}}min</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <a href="/teacher/courses/{{this.id}}/edit" class="btn btn-primary btn-sm">
                                    <i class="fas fa-edit mr-1"></i>Edit
                                </a>
                                <button class="btn btn-secondary btn-sm" onclick="duplicateCourse({{this.id}})">
                                    <i class="fas fa-copy mr-1"></i>Duplicate
                                </button>
                                <button class="btn btn-secondary btn-sm text-red-600" onclick="deleteCourse({{this.id}})">
                                    <i class="fas fa-trash mr-1"></i>Delete
                                </button>
                            </div>
                        </div>
                    </div>
                    {{/each}}
                </div>
            {{else}}
                <div class="text-center py-16">
                    <div class="text-8xl mb-6 opacity-50">üìö</div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">No courses yet</h3>
                    <p class="text-gray-600 mb-8">Create your first course to start teaching and engaging with students</p>
                    <a href="/teacher/courses/create" class="btn btn-primary btn-lg">
                        <i class="fas fa-plus mr-2"></i>Create Your First Course
                    </a>
                </div>
            {{/if}}
        </div>
    </div>

    <script>
        // Search and filter functionality
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('courseSearch');
            const categoryFilter = document.getElementById('categoryFilter');
            const statusFilter = document.getElementById('statusFilter');
            const courseCards = document.querySelectorAll('.course-card');

            function filterCourses() {
                const searchTerm = searchInput.value.toLowerCase();
                const selectedCategory = categoryFilter.value;
                const selectedStatus = statusFilter.value;

                courseCards.forEach(card => {
                    const title = card.querySelector('h3').textContent.toLowerCase();
                    const category = card.dataset.category;
                    const status = card.dataset.status;

                    const matchesSearch = title.includes(searchTerm);
                    const matchesCategory = !selectedCategory || category === selectedCategory;
                    const matchesStatus = !selectedStatus || status === selectedStatus;

                    if (matchesSearch && matchesCategory && matchesStatus) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                });
            }

            searchInput.addEventListener('input', filterCourses);
            categoryFilter.addEventListener('change', filterCourses);
            statusFilter.addEventListener('change', filterCourses);
        });

        // View toggle functionality
        function toggleView(viewType) {
            const gridView = document.getElementById('gridView');
            const listView = document.getElementById('listView');

            if (viewType === 'grid') {
                gridView.classList.remove('hidden');
                listView.classList.add('hidden');
            } else {
                gridView.classList.add('hidden');
                listView.classList.remove('hidden');
            }
        }

        // Course actions
        function duplicateCourse(courseId) {
            if (confirm('Are you sure you want to duplicate this course?')) {
                // In a real app, this would make an API call
                alert(`Course ${courseId} duplicated! (Demo mode)`);
            }
        }

        function deleteCourse(courseId) {
            if (confirm('Are you sure you want to delete this course? This action cannot be undone.')) {
                // In a real app, this would make an API call
                alert(`Course ${courseId} deleted! (Demo mode)`);
            }
        }

        // Add hover effects to cards
        document.querySelectorAll('.card-hover').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-4px)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });

        // Auto-hide success message after 5 seconds
        const successMessage = document.querySelector('.bg-green-100');
        if (successMessage) {
            setTimeout(() => {
                successMessage.style.opacity = '0';
                setTimeout(() => {
                    successMessage.style.display = 'none';
                }, 300);
            }, 5000);
        }
    </script>
</body>
</html>